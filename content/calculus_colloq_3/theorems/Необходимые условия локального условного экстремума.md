## Теорема (необходимые условия локального условного экстремума)
Формулировка:
```spoiler-markdown
Пусть $f(\mathbf{x})$ и $g_k(\mathbf{x}), k = \overline{1, n}$ непрерывно дифференцируемы на $D$.
Ранг матрицы
$$
\begin{pmatrix}
\dfrac{\partial g_1}{\partial x_1} & \dots & \dfrac{\partial g_1}{\partial x_m} \\
\dots & \dots & \dots \\
\dfrac{\partial g_n}{\partial x_1} & \dots & \dfrac{\partial g_n}{\partial x_m}
\end{pmatrix}
$$
в точке $\mathbf{x}^0 \in D$ равен $n < m$.
Если $\mathbf{x}^0$ точка условного локального экстремума функции $f(\mathbf{x})$, при наличии уравнений связи $g_k(\mathbf{x}) = 0, k = \overline{1, n}$,
то $\exists{\lambda_1, \dots, \lambda_n \in \mathbb{R}}$ такие, что $\mathbf{x}^0$ стационарная точка функции
$$
L(\mathbf{x}) = L(x_1, \dots, x_m, \lambda_1, \dots, \lambda_n) = f(\mathbf{x}) - \sum_{k=1}^{n} \lambda_k g_k(\mathbf{x}).
$$
```

Д-во:
```spoiler-markdown
Б.О.О., пусть якобиан, составленный из первых $n$ переменных, ненулевой:
$$
J = \dfrac{\partial(g_1, \dots, g_n)}{\partial(x_1, \dots, x_n)} (\mathbf{x}^0) =
\begin{vmatrix}
\dfrac{\partial g_1}{\partial x_1} & \dots & \dfrac{\partial g_1}{\partial x_n} \\
\dots & \dots & \dots \\
\dfrac{\partial g_n}{\partial x_1} & \dots & \dfrac{\partial g_n}{\partial x_n}
\end{vmatrix} \neq 0.
$$
По теореме о неявных функциях на некотором кубе $K$ найдутся функции
$\varphi_1(x_{n+1}, \dots, x_m), \dots, \varphi_n(x_{n+1}, \dots, x_m)$ такие, что:
$$
g_k(\varphi_1(x_{n+1}, \dots, x_m), \dots, \varphi_n(x_{n+1}, \dots, x_m), x_{n+1}, \dots, x_m) \equiv 0, k = \overline{1, n}.
$$
Точка $\mathbf{x}^0$ является точкой условного экстремума $f(\mathbf{x}) \iff$ $(\mathbf{x}_{n+1}^0, \dots, \mathbf{x}_m^0)$ является точкой локального экстремума функции
$$
h(x_{n+1}, \dots, x_m) = f(\varphi_1(x_{n+1}, \dots, x_m), \dots, \varphi_n(x_{n+1}, \dots, x_m), x_{n+1}, \dots, x_m).
$$
Запишем условие стационарности $(\mathbf{x}_{n+1}^0, \dots, \mathbf{x}_m^0)$ для функции $h$ и воспользуемся инвариантностью формы первого дифференциала. Из условия $dh=0$ следует, что для всех допустимых вариаций $d\mathbf{x}$ выполняется:
$$
dh(\mathbf{x}_{n+1}^0, \dots, \mathbf{x}_m^0) = \sum_{j=1}^{m} \dfrac{\partial f}{\partial x_j}(\mathbf{x}^0) dx_j = 0.
$$
Также, дифференцируя тождество $g_k \equiv 0$, получаем условия на вариации $d\mathbf{x}$:
$$
dg_k(\mathbf{x}^0) = \sum_{j=1}^{m} \dfrac{\partial g_k}{\partial x_j}(\mathbf{x}^0) dx_j = 0, \quad k = \overline{1, n}.
$$
Значит системы уравнений относительно $d\mathbf{x} = (dx_1, \dots, dx_m)$ равносильны:
$$
\begin{pmatrix}
\dfrac{\partial g_1}{\partial x_1} & \dots & \dfrac{\partial g_1}{\partial x_m} \\
\dots & \dots & \dots \\
\dfrac{\partial g_n}{\partial x_1} & \dots & \dfrac{\partial g_n}{\partial x_m}
\end{pmatrix}
\iff
\begin{pmatrix}
\dfrac{\partial g_1}{\partial x_1} & \dots & \dfrac{\partial g_1}{\partial x_m} \\
\dots & \dots & \dots \\
\dfrac{\partial g_n}{\partial x_1} & \dots & \dfrac{\partial g_n}{\partial x_m} \\
\dfrac{\partial f}{\partial x_1} & \dots & \dfrac{\partial f}{\partial x_m}
\end{pmatrix}
$$
Так как системы равносильны, их матрицы имеют одинаковый ранг $n$. А значит последняя строка (градиент $f$) есть линейная комбинация первых $n$ строк (градиентов $g_k$):
$$
\exists{\lambda_1, \dots, \lambda_n}\mathpunct{:}~~ \dfrac{\partial f}{\partial x_j}(\mathbf{x}^0) = \sum_{k=1}^{n} \lambda_k \dfrac{\partial g_k}{\partial x_j}(\mathbf{x}^0), \quad \forall{j = \overline{1, m}}.
$$
Это условие означает, что $\nabla L(\mathbf{x}^0) = 0$, то есть $\mathbf{x}^0$ является стационарной точкой функции Лагранжа $L(\mathbf{x})$.
$\square$
```
