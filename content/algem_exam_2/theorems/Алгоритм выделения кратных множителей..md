## Отделение кратных множителей

**Алгоритм:**  
Пусть $f \in F[x]$ – многочлен над полем характеристики $0$ с разложением:  
$$f = \alpha p_1^{k_1} p_2^{k_2} \cdots p_m^{k_m}$$  
где $p_i$ – попарно различные неприводимые множители, $k_i \geq 1$.  
Обозначим $k = \max_i \{k_i\}$.

---

### Шаг 1: Построение множителей $d_j$  
Для каждого $j = 1, 2, \dots, k$ определим:  
$$d_j := \prod_{\substack{i \\ k_i = j}} p_i$$  
(если множителей кратности $j$ нет, то $d_j := 1$).  

Тогда $f$ представляется в виде:  
$$f = \alpha d_1 d_2^2 d_3^3 \cdots d_k^k$$  

---

### Шаг 2: Первая итерация  
1. Вычислим $f_1 := \text{НОД}(f, f')$  
   $$f_1 = d_2 d_3^2 d_4^3 \cdots d_k^{k-1}$$  
2. Вычислим $g_1 := \frac{f}{\alpha f_1}$  
   $$g_1 = d_1 d_2 d_3 \cdots d_k$$  
   ($g_1$ – произведение всех различных неприводимых множителей $f$)

---

### Шаг 3: Рекурсивное применение  
1. Для $f_1$ вычислим $f_2 := \text{НОД}(f_1, f_1')$  
   $$f_2 = d_3 d_4^2 \cdots d_k^{k-2}$$  
2. Вычислим $g_2 := \frac{f_1}{f_2}$  
   $$g_2 = d_2 d_3 \cdots d_k$$  

---

### Шаг 4: Выделение $d_j$  
1. Найдем $d_1$:  
   $$d_1 = \frac{g_1}{g_2}$$  
2. Продолжаем процесс для выделения $d_2, d_3, \dots$:  
   - $d_2 = \frac{g_2}{g_3}$ где $g_3 = \frac{f_2}{f_3}$  
   - $d_3 = \frac{g_3}{g_4}$ и т.д.  

---

**Обоснование:**  
Из предложения о неприводимых множителях:  
- В $f_1 = \text{НОД}(f, f')$ кратность каждого $p_i$ уменьшается на 1  
- Поэтому $f_1$ содержит $d_j$ в степени $(j-1)$ для $j \geq 2$  
